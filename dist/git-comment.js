!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.gitComment=t():e.gitComment=t()}(window,function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/dist/",n(n.s=8)}([function(e,t,n){"use strict";function o(e){return Object.keys(e).map(function(t){return t+"="+encodeURIComponent(e[t])}).join("&")}Object.defineProperty(t,"__esModule",{value:!0}),t.stringifyQuery=o,t.appendQuery=function(e,t){if(!~e.indexOf("?"))return e+"?"+o(t);"&"!==e[e.length-1]&&(e="&"+e);return e+o(t)},t.getQuery=function(e,t){var n=new RegExp(t+"=([^&]*)"),o=e.match(n);if(o&&o.length)return o[1];return""}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={client_id:"",client_secret:"",access_token:"",ifLogin:!1}},,function(e,t,n){},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=new Promise(function(e,n){t.resolve=e,t.reject=n});this.then=n.then.bind(n),this.catch=n.catch.bind(n),this.promise=n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(4)),r=i(n(1)),u=n(0);function i(e){return e&&e.__esModule?e:{default:e}}var c="https://api.github.com";function a(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];e=e.toUpperCase(),/^http/.test(t)||(t=c+t),i&&(t="https://cors-anywhere.herokuapp.com/"+t);var a=new o.default,s=new XMLHttpRequest;return s.onreadystatechange=function(){4==this.readyState&&200==this.status&&a.resolve(this.responseText)},s.onerror=function(e){a.reject(e.message)},"GET"===e?(t=(0,u.appendQuery)(t,n),n=null):"POST"===e&&(n=JSON.stringify(n)),s.open(e,t,!0),r.default.access_token&&s.setRequestHeader("Authorization","token "+r.default.access_token),"POST"===e&&s.setRequestHeader("Content-Type","application/json"),s.send(n),a.promise}t.default={get:function(e,t,n){return a("get",e,t,n)},post:function(e,t,n){return a("post",e,t,n)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFirstIssue=function(e,t,n){return o.default.get("/repos/"+e+"/"+t+"/issues",{creator:e,labels:n}).then(function(e){return JSON.parse(e)[0]})},t.getIssue=function(e,t,n){return o.default.get("/repos/"+e+"/"+t+"/issues/"+n).then(function(e){return JSON.parse(e)})},t.getToken=function(e,t,n){return o.default.post("https://github.com/login/oauth/access_token",{client_id:u.default.client_id,client_secret:u.default.client_secret,code:n},!0).then(function(e){return(0,r.getQuery)(e,"access_token")})},t.toAuthorize=function(e){var t="https://github.com/login/oauth/authorize";t=(0,r.appendQuery)(t,{client_id:e,redirect_uri:window.location.href,scope:"public_repo",state:window.location.href}),window.location.href=t},t.getAuthUser=function(){return o.default.get("/user")};var o=i(n(5)),r=n(0),u=i(n(1));function i(e){return e&&e.__esModule?e:{default:e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u=n(1),i=(o=u)&&o.__esModule?o:{default:o},c=n(0),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(6));n(3);
/**
 * https://github.com/shalldie/git-comment
 *
 * @license MIT License
 * @description 一个基于 issue 的评论插件。
 * @author shalldie
 */
var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.state=i.default}return r(e,[{key:"config",value:function(e){var t=e.client_id,n=e.client_secret;i.default.client_id=t,i.default.client_secret=n,this.init()}},{key:"init",value:function(){this._updateToken(localStorage.getItem("GIT_COMMENT_ACCESS_STOKEN")),this._checkBack()}},{key:"_checkBack",value:function(){var e=window.location.search;if(/(?=\S*code=\S*)(?=\S*state=\S*)/.test(e)){var t=(0,c.getQuery)(window.location.search,"code");this._getToken(t)}}},{key:"_getToken",value:function(e){var t=this,n=(0,c.getQuery)(window.location.search,"state");n=decodeURIComponent(n),a.getToken(i.default.client_id,i.default.client_secret,e).then(function(e){t._updateToken(e),window.history.replaceState(null,null,n)}).catch(function(e){return console.log(e)})}},{key:"_updateToken",value:function(e){e&&e.length?(i.default.ifLogin=!0,i.default.access_token=e):(i.default.ifLogin=!1,i.default.access_token=""),window.localStorage.setItem("GIT_COMMENT_ACCESS_STOKEN",i.default.access_token)}},{key:"login",value:function(){a.toAuthorize(i.default.client_id)}},{key:"getUserInfo",value:function(){a.getAuthUser().then(function(e){return console.log(e)})}}]),e}();t.default=new s},function(e,t,n){e.exports=n(7)}]).default});